<div class="container page-contain mt-5">
  <form action="/" method="GET" id="category-form">
    <div class="input-group">
      <select class="custom-select custom-select-lg" name="category" onchange="category-form.submit()">
        <option value=0 {{#isEqual 0 categoryId}}selected{{/isEqual}}>全部</option>
        {{#each categories}}
        <option value={{this.id}} {{#isEqual this.id ../categoryId}}selected{{/isEqual}}>{{this.name}}</option>
        {{/each}}
      </select>
    </div>
  </form>

  <div class="mt-3">
    <h3>總金額:</h3>
    <div class="index-total-amount text-right pr-1">{{sumOfAmount expenses}}</div>
  </div>
  <div>    
    <ul class="list-group" id="expense-items">
      {{#each expenses}}
      <li class="p-2">
        <div class="d-flex align-items-center">
          <div>
            <i class="fas {{nestLookUp ../categories this.categoryId "class"}}"></i>
          </div>
          <div class="flex-grow-1"><div>{{this.name}}</div><div>{{formatDate this.date "/"}}</div></div>
          <div class="mr-2">{{this.amount}}$</div>
          <a class="btn btn-link" href="./expenses/{{this.id}}/edit">編輯</a>
          <form action="./expenses/{{this.id}}?_method=DELETE" method="POST" style="margin-block-end:0">
            <button class="btn btn-link" type="submit">刪除</button>
          </form>
        </div>
      </li>
      {{/each}}
    </ul>
  </div>
  <div class="text-center mt-3">
    <a href="/expenses/new" class="btn btn-warning">新增支出</a>
  </div>

</div>